!function(){"use strict";var t=new Vue,e={data:function(){return{Dialog:!1,cardData:"",start:!1,employees:"",timer:{hours:0,minutes:0,seconds:0}}},watch:{Dialog:function(t){t&&this.get_employees()}},methods:{close_dialog:function(){this.Dialog=!1},start_por:function(){if(this.cardData.employee){this.start=!0;var e=frappe.model.add_child(this.cardData,"Job Card Time Log","time_logs");e.from_time=frappe.datetime.now_datetime(),e.job_started=1,e.started_time=e.from_time,e.status="Work In Progress",frappe.flags.resume_job||(this.cardData.current_time=0)}else t.$emit("show_messag","Please set Employee")},pause_por:function(){this.start=!1},get_employees:function(){var t;frappe.call({method:"csf_tz.csf_tz.page.jobcards.jobcards.get_employees",args:{company:this.cardData.company},async:!1,callback:function(e){e.message&&(t=e.message)}}),this.employees=t},customFilter:function(t,e,n){var a=e.toLowerCase(),s=t.name.toLowerCase(),r=t.employee_name.toLowerCase();return s.indexOf(a)>-1||r.indexOf(a)>-1},set_timer:function(){var t=this,e=this.cardData.current_time||0;if(this.cardData.started_time||this.cardData.current_time){function n(e){var n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),s=e-3600*n-60*a;t.timer.hours=n<10?"0"+n.toString():n.toString(),t.timer.minutes=a<10?"0"+a.toString():a.toString(),t.timer.seconds=s<10?"0"+s.toString():s.toString()}"On Hold"==this.cardData.status?(n(e),console.log("currentIncrement",e)):(console.log("else"),e+=moment(frappe.datetime.now_datetime()).diff(moment(this.cardData.started_time),"seconds"),console.log("diff",e),setInterval(function(){var t=e+=1;console.log("current",t),n(t)},1e3))}}},created:function(){var e=this;t.$on("open_card",function(t){e.Dialog=!0,e.cardData=t,e.timer={hours:0,minutes:0,seconds:0},e.set_timer()})}},n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.Dialog?n("div",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{"max-width":"1200px"},model:{value:t.Dialog,callback:function(e){t.Dialog=e},expression:"Dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline indigo--text"},[t._v(t._s(t.cardData.operation.name))]),t._v(" "),n("v-spacer"),t._v(" "),n("div",{staticClass:"stopwatch",staticStyle:{"font-weight":"bold",margin:"0px 13px 0px 2px",color:"#545454","font-size":"18px",display:"inline-block","vertical-align":"text-bottom"}},[n("span",{staticClass:"hours"},[t._v(t._s(t.timer.hours))]),t._v(" "),n("span",{staticClass:"colon"},[t._v(":")]),t._v(" "),n("span",{staticClass:"minutes"},[t._v(t._s(t.timer.minutes))]),t._v(" "),n("span",{staticClass:"colon"},[t._v(":")]),t._v(" "),n("span",{staticClass:"seconds"},[t._v(t._s(t.timer.seconds))])]),t._v(" "),n("v-spacer"),t._v(" "),n("span",{staticClass:"overline"},[t._v(t._s(t.cardData.name))])],1),t._v(" "),n("v-row",{staticClass:"mx-3"},[n("v-col",{attrs:{cols:"5"}},[n("v-img",{staticClass:"img-border",attrs:{"max-height":"600","max-width":"600",src:t.cardData.operation.image||"/assets/csf_tz/js/jobcards/placeholder-image.png"}})],1),t._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-card-text",{staticClass:"pa-0"},[n("v-list-item",{attrs:{"three-line":""}},[n("v-list-item-content",[n("v-textarea",{attrs:{label:"Operation Description","auto-grow":"",outlined:"",rows:"3","row-height":"25",readonly:""},model:{value:t.cardData.operation.description,callback:function(e){t.$set(t.cardData.operation,"description",e)},expression:"cardData.operation.description"}}),t._v(" "),n("v-list-item-subtitle",{staticClass:"subtitle-1 mb-1"},[t._v("\n                  QTY: "+t._s(t.cardData.for_quantity)+"\n                ")]),t._v(" "),n("v-list-item-subtitle",{staticClass:"subtitle-1 mb-1"},[t._v("\n                  Production Item: "+t._s(t.cardData.production_item)+"\n                ")]),t._v(" "),n("v-list-item-subtitle",{staticClass:"subtitle-1 mb-1"},[t._v("\n                  Satus: "+t._s(t.cardData.status)+"\n                ")])],1)],1)],1)],1),t._v(" "),n("v-col",{attrs:{cols:"3"}},[n("v-img",{staticClass:"img-border",attrs:{"max-height":"400","max-width":"400",src:t.cardData.work_order_image||"/assets/csf_tz/js/jobcards/placeholder-image.png"}}),t._v(" "),n("v-divider"),t._v(" "),n("v-autocomplete",{attrs:{dense:"","auto-select-first":"",outlined:"",color:"indigo",label:"Employee",items:t.employees,"item-text":"name","background-color":"white","no-data-text":"Customer not found","hide-details":"",readonly:!!t.cardData.employee,filter:t.customFilter},scopedSlots:t._u([{key:"item",fn:function(e){return[[n("v-list-item-content",[n("v-list-item-title",{staticClass:"indigo--text subtitle-1",domProps:{innerHTML:t._s(e.item.name)}}),t._v(" "),n("v-list-item-subtitle",{domProps:{innerHTML:t._s(""+e.item.employee_name)}})],1)]]}}],null,!1,803306625),model:{value:t.cardData.employee,callback:function(e){t.$set(t.cardData,"employee",e)},expression:"cardData.employee"}})],1)],1),t._v(" "),n("v-card-actions",{staticClass:"mx-3"},[t.start?t._e():n("v-btn",{attrs:{color:"success",dark:""},on:{click:t.start_por}},[t._v("Start")]),t._v(" "),t.start?n("v-btn",{attrs:{color:"warning",dark:""},on:{click:t.pause_por}},[t._v("Pause")]):t._e(),t._v(" "),n("v-btn",{attrs:{color:"primary",dark:""},on:{click:t.close_dialog}},[t._v("Submit")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"error",dark:""},on:{click:t.close_dialog}},[t._v("Close")])],1)],1)],1)],1):t._e()};n._withStripped=!0;var a={data:function(){return{data:""}},components:{Card:function(t,e,n,a,s,r,i,o){var l,d=("function"==typeof n?n.options:n)||{};if(d.__file="/home/frappe/frappe-bench/apps/csf_tz/csf_tz/public/js/jobcards/Card.vue",d.render||(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,s&&(d.functional=!0)),d._scopeId=a,e&&(l=function(t){e.call(this,i(t))}),void 0!==l)if(d.functional){var c=d.render;d.render=function(t,e){return l.call(e),c(t,e)}}else{var m=d.beforeCreate;d.beforeCreate=m?[].concat(m,l):[l]}return d}({render:n,staticRenderFns:[]},function(t){t&&t("data-v-1e101242_0",{source:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",map:{version:3,sources:[],names:[],mappings:"",file:"Card.vue"},media:void 0})},e,void 0,!1,0,function t(){var e=document.head||document.getElementsByTagName("head")[0],n=t.styles||(t.styles={}),a="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(t,s){if(!document.querySelector('style[data-vue-ssr-id~="'+t+'"]')){var r=a?s.media||"default":t,i=n[r]||(n[r]={ids:[],parts:[],element:void 0});if(!i.ids.includes(t)){var o=s.source,l=i.ids.length;if(i.ids.push(t),a&&(i.element=i.element||document.querySelector("style[data-group="+r+"]")),!i.element){var d=i.element=document.createElement("style");d.type="text/css",s.media&&d.setAttribute("media",s.media),a&&(d.setAttribute("data-group",r),d.setAttribute("data-next-index","0")),e.appendChild(d)}if(a&&(l=parseInt(i.element.getAttribute("data-next-index")),i.element.setAttribute("data-next-index",l+1)),i.element.styleSheet)i.parts.push(o),i.element.styleSheet.cssText=i.parts.filter(Boolean).join("\n");else{var c=document.createTextNode(o),m=i.element.childNodes;m[l]&&i.element.removeChild(m[l]),m.length?i.element.insertBefore(c,m[l]):i.element.appendChild(c)}}}}})},methods:{get_data:function(){var t=this;frappe.call({method:"csf_tz.csf_tz.page.jobcards.jobcards.get_job_cards",args:{},async:!0,callback:function(e){e.message&&(t.data=e.message)}})},open_card:function(e){t.$emit("open_card",e)},set_status_color:function(t){return"Open"==t?"status-Open":"Work In Progress"==t?"status-Work":"Material Transferred"==t?"status-Material":"On Hold"==t?"status-Hold":"Submitted"==t?"status-Submitted":void 0}},created:function(){this.get_data(),t.$on("show_messag",function(t){frappe.msgprint(t)})}},s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("div",{attrs:{fluid:""}},[n("H3",[t._v(" Working Job Cards")]),t._v(" "),n("Card"),t._v(" "),t._l(t.data,function(e){return n("div",{key:e.name},[n("div",{class:t.set_status_color(e.status)},[n("v-card",{staticClass:"mb-4"},[n("v-list-item",{attrs:{"three-line":""}},[n("v-list-item-content",[n("div",{staticClass:"overline mb-4"},[t._v(t._s(e.name))]),t._v(" "),n("v-list-item-title",{staticClass:"headline mb-1"},[t._v("\n                "+t._s(e.operation.name)+"\n              ")]),t._v(" "),n("v-list-item-subtitle",[t._v("\n                QTY: "+t._s(e.for_quantity)+"\n              ")]),t._v(" "),n("v-list-item-subtitle",[t._v("\n                Production Item: "+t._s(e.production_item)+"\n              ")]),t._v(" "),n("v-list-item-subtitle",[t._v("\n                Satus: "+t._s(e.status)+"\n              ")]),t._v(" "),e.current_time?n("v-card-subtitle",[t._v("Current Time: "+t._s(e.current_time/60))]):t._e()],1),t._v(" "),n("v-img",{staticClass:"img-border mt-5",attrs:{"max-height":"150","max-width":"250",src:e.operation.image||"/assets/csf_tz/js/jobcards/placeholder-image.png"}})],1),t._v(" "),n("v-card-actions",[n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(n){return t.open_card(e)}}},[t._v("\n              open\n            ")])],1)],1)],1)])})],2)])};s._withStripped=!0;var r=function(t,e,n,a,s,r,i,o){var l,d=("function"==typeof n?n.options:n)||{};if(d.__file="/home/frappe/frappe-bench/apps/csf_tz/csf_tz/public/js/jobcards/JobCards.vue",d.render||(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,s&&(d.functional=!0)),d._scopeId=a,e&&(l=function(t){e.call(this,i(t))}),void 0!==l)if(d.functional){var c=d.render;d.render=function(t,e){return l.call(e),c(t,e)}}else{var m=d.beforeCreate;d.beforeCreate=m?[].concat(m,l):[l]}return d}({render:s,staticRenderFns:[]},function(t){t&&t("data-v-8c7c9d6c_0",{source:"\n.navbar-default {\n  height: 40px;\n}\ndiv.navbar .container {\n  padding-top: 2px;\n}\n.status-Open {\n  border-left: 5px solid purple;\n}\n.status-Work {\n  border-left: 5px solid lime;\n}\n.status-Material {\n  border-left: 5px solid teal;\n}\n.status-Hold {\n  border-left: 5px solid #607d8b;\n}\n.status-Submitted {\n  border-left: 5px solid #ff5722;\n}\n.img-border {\n  border: 1px solid #BDBDBD;\n}\n",map:{version:3,sources:["/home/frappe/frappe-bench/apps/csf_tz/csf_tz/public/js/jobcards/JobCards.vue"],names:[],mappings:";AA+GA;EACA,YAAA;AACA;AACA;EACA,gBAAA;AACA;AACA;EACA,6BAAA;AACA;AACA;EACA,2BAAA;AACA;AACA;EACA,2BAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,yBAAA;AACA",file:"JobCards.vue",sourcesContent:['<template>\n  <v-app>\n    <div fluid>\n      <H3> Working Job Cards</H3>\n      <Card></Card>\n      <div v-for="item in data" :key="item.name">\n        <div :class="set_status_color(item.status)">\n          <v-card class="mb-4">\n            <v-list-item three-line>\n              <v-list-item-content>\n                <div class="overline mb-4">{{ item.name }}</div>\n                <v-list-item-title class="headline mb-1">\n                  {{ item.operation.name }}\n                </v-list-item-title>\n                <v-list-item-subtitle>\n                  QTY: {{ item.for_quantity }}\n                </v-list-item-subtitle>\n                <v-list-item-subtitle>\n                  Production Item: {{ item.production_item }}\n                </v-list-item-subtitle>\n                <v-list-item-subtitle>\n                  Satus: {{ item.status }}\n                </v-list-item-subtitle>\n                <v-card-subtitle v-if="item.current_time"\n                  >Current Time: {{ item.current_time / 60 }}</v-card-subtitle\n                >\n              </v-list-item-content>\n\n              <v-img\n                max-height="150"\n                max-width="250"\n                class="img-border mt-5"\n                :src="\n                  item.operation.image ||\n                  \'/assets/csf_tz/js/jobcards/placeholder-image.png\'\n                "\n              ></v-img>\n      \n            </v-list-item>\n\n            <v-card-actions>\n              \x3c!-- <v-spacer></v-spacer> --\x3e\n              <v-btn text color="primary" @click="open_card(item)">\n                open\n              </v-btn>\n            </v-card-actions>\n          </v-card>\n        </div>\n      </div>\n    </div>\n  </v-app>\n</template>\n\n<script>\nimport { evntBus } from "./bus";\nimport Card from "./Card.vue";\n\nexport default {\n  data: function () {\n    return {\n      data: "",\n    };\n  },\n  components: {\n    Card,\n  },\n\n  methods: {\n    get_data() {\n      const vm = this;\n      frappe.call({\n        method: "csf_tz.csf_tz.page.jobcards.jobcards.get_job_cards",\n        args: {},\n        async: true,\n        callback: function (r) {\n          if (r.message) {\n            vm.data = r.message;\n          }\n        },\n      });\n    },\n    open_card(item) {\n      evntBus.$emit("open_card", item);\n    },\n    set_status_color(status) {\n      if (status == "Open") {\n        return "status-Open";\n      }\n      if (status == "Work In Progress") {\n        return "status-Work";\n      }\n      if (status == "Material Transferred") {\n        return "status-Material";\n      }\n      if (status == "On Hold") {\n        return "status-Hold";\n      }\n      if (status == "Submitted") {\n        return "status-Submitted";\n      }\n    },\n  },\n  created: function () {\n    this.get_data();\n    evntBus.$on("show_messag", (msg) => {\n      frappe.msgprint(msg);\n    });\n  },\n};\n<\/script>\n<style>\n.navbar-default {\n  height: 40px;\n}\ndiv.navbar .container {\n  padding-top: 2px;\n}\n.status-Open {\n  border-left: 5px solid purple;\n}\n.status-Work {\n  border-left: 5px solid lime;\n}\n.status-Material {\n  border-left: 5px solid teal;\n}\n.status-Hold {\n  border-left: 5px solid #607d8b;\n}\n.status-Submitted {\n  border-left: 5px solid #ff5722;\n}\n.img-border {\n  border: 1px solid #BDBDBD;\n}\n</style>']},media:void 0})},a,void 0,!1,0,function t(){var e=document.head||document.getElementsByTagName("head")[0],n=t.styles||(t.styles={}),a="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(t,s){if(!document.querySelector('style[data-vue-ssr-id~="'+t+'"]')){var r=a?s.media||"default":t,i=n[r]||(n[r]={ids:[],parts:[],element:void 0});if(!i.ids.includes(t)){var o=s.source,l=i.ids.length;if(i.ids.push(t),a&&(i.element=i.element||document.querySelector("style[data-group="+r+"]")),!i.element){var d=i.element=document.createElement("style");d.type="text/css",s.media&&d.setAttribute("media",s.media),a&&(d.setAttribute("data-group",r),d.setAttribute("data-next-index","0")),e.appendChild(d)}if(a&&(l=parseInt(i.element.getAttribute("data-next-index")),i.element.setAttribute("data-next-index",l+1)),i.element.styleSheet)i.parts.push(o),i.element.styleSheet.cssText=i.parts.filter(Boolean).join("\n");else{var c=document.createTextNode(o),m=i.element.childNodes;m[l]&&i.element.removeChild(m[l]),m.length?i.element.insertBefore(c,m[l]):i.element.appendChild(c)}}}}});frappe.provide("frappe.JobCards"),frappe.JobCards.job_cards=class{constructor(t){var e=t.parent;this.$parent=$(e),this.page=e.page,this.make_body()}make_body(){this.$EL=this.$parent.find(".layout-main"),this.vue=new Vue({vuetify:new Vuetify,el:this.$EL[0],data:{},render:function(t){return t(r)}})}setup_header(){}}}();
//# sourceMappingURL=jobcards.min.js.map
